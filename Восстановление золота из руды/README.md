# Проект для промышленного предприятия
## Оптимизация производства

**Задача проекта:** подготовить прототип модели машинного обучения для «Цифры». Компания разрабатывает решения для эффективной работы промышленных предприятий.

Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. В нашем распоряжении данные с параметрами добычи и очистки.

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

**Задачи:**

- Подготовить данные;
- Провести исследовательский анализ данных;
- Построить и обучить модель.

В нашем распоряжении три датасета с числовыми признаками разных стадий обработки руды. Обучающая и тестовая выборки, и исходный датасет, содержащий обучающую и тестовую выборки со всеми признаками.

**В ходе проекта нужно спрогнозировать:**

- эффективность обогащения чернового концентрата rougher.output.recovery;
- эффективность обогащения финального концентрата final.output.recovery.
- рассчитать итоговую метрику из этих двух величин.
- подобрать модель, предсказывающую коэффициент восстановления золота из золотосодержащей руды.

**В ходе проекта планируется:**

- исследовать данные,
- проверить эффективность обогащения для признака rougher.output.recovery, посчитав метрику MAE между расчётами и значением признака,
- сравнить выборки и корректность их выгрузки,
- провести предобработку данных,
- исследовать концентрацию металлов (Au, Ag, Pb) на разных стадиях обработки,
- сравнить распределения размеров гранул сырья на обучающей и тестовой выборках,
- обучить разные модели и оценить их качество кросс-валидацией, лучшую модель проверить на тестовой выборке.

## Итоговые выводы: 

В рамках проекта было проведено исследование данных по обработке золотосодержащей руды, целью было смоделировать процесс восстановления золота из золотосодержащей руды, предсказывающий эффективность обогащения руды.

**В ходе проекта:**

- Была проведена предобработка данных.
- Были заполнены пропущенные значения.
- Добавлены целевые признаки в тестовую выборку.
- Проведена проверка значений эффективности обогащения (эффективность рассчитана корректно)
- Исследование концентрации металлов (Au, Ag, Pb) на разных стадиях обработки показало уменьшение концентрации к финальному этапу очистки Ag, Pb, и увеличение концентрации Au.

Распределения размеров гранул сырья на обучающей и тестовой выборках по форме распределения совпадают.

Обучение моделей проводилось для целевых признаков *'rougher.output.recovery'* и *'final.output.recovery'* отдельно с помощью трех алгоритмов: *LinearRegression, DecisionTreeRegressor, RandomForestRegressor*. Оценкаих качества кросс-валидацией показало лучшую модель для признака *'rougher.output.recovery'* случайного дерева с параметрами *max_depth=6, n_estimators=200* с метрикой *sMAPE 6.17*. Для признака '*final.output.recovery*' лучший показатель метрики *sMAPE равен 8.59* в моделе случайного дерева с параметрами *max_depth=4, n_estimators=300*.

Итоговое значение метрики *sMAPE* на тестовой выборке мы получили равным *9.33*.

*Использованный стек: pandas, numpy, matplotlib, seaborn, sklearn.*
